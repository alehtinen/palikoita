<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Päivää!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#8b5cf6',
                    }
                }
            }
        }
    </script>
    <style>
        /* Tailwind JIT safelist - all possible dynamic color classes */
        .bg-blue-50,.bg-blue-100,.bg-blue-200,.bg-blue-500,.bg-blue-600,.bg-blue-700,.bg-blue-800,.bg-blue-900,
        .bg-purple-50,.bg-purple-100,.bg-purple-200,.bg-purple-500,.bg-purple-600,.bg-purple-700,.bg-purple-800,.bg-purple-900,
        .bg-green-50,.bg-green-100,.bg-green-200,.bg-green-500,.bg-green-600,.bg-green-700,.bg-green-800,.bg-green-900,
        .bg-red-50,.bg-red-100,.bg-red-200,.bg-red-500,.bg-red-600,.bg-red-700,.bg-red-800,.bg-red-900,
        .bg-yellow-50,.bg-yellow-100,.bg-yellow-200,.bg-yellow-500,.bg-yellow-600,.bg-yellow-700,.bg-yellow-800,.bg-yellow-900,
        .bg-orange-50,.bg-orange-100,.bg-orange-200,.bg-orange-500,.bg-orange-600,.bg-orange-700,.bg-orange-800,.bg-orange-900,
        .bg-pink-50,.bg-pink-100,.bg-pink-200,.bg-pink-500,.bg-pink-600,.bg-pink-700,.bg-pink-800,.bg-pink-900,
        .bg-indigo-50,.bg-indigo-100,.bg-indigo-200,.bg-indigo-500,.bg-indigo-600,.bg-indigo-700,.bg-indigo-800,.bg-indigo-900,
        .bg-cyan-50,.bg-cyan-100,.bg-cyan-200,.bg-cyan-500,.bg-cyan-600,.bg-cyan-700,.bg-cyan-800,.bg-cyan-900,
        .bg-teal-50,.bg-teal-100,.bg-teal-200,.bg-teal-500,.bg-teal-600,.bg-teal-700,.bg-teal-800,.bg-teal-900,
        .bg-gray-50,.bg-gray-100,.bg-gray-200,.bg-gray-500,.bg-gray-600,.bg-gray-700,.bg-gray-800,.bg-gray-900,
        .text-blue-200,.text-blue-400,.text-blue-600,.text-blue-800,
        .text-purple-200,.text-purple-400,.text-purple-600,.text-purple-800,
        .text-green-200,.text-green-400,.text-green-600,.text-green-800,
        .text-red-200,.text-red-400,.text-red-600,.text-red-800,
        .text-yellow-200,.text-yellow-400,.text-yellow-600,.text-yellow-800,
        .text-orange-200,.text-orange-400,.text-orange-600,.text-orange-800,
        .text-pink-200,.text-pink-400,.text-pink-600,.text-pink-800,
        .text-indigo-200,.text-indigo-400,.text-indigo-600,.text-indigo-800,
        .text-cyan-200,.text-cyan-400,.text-cyan-600,.text-cyan-800,
        .text-teal-200,.text-teal-400,.text-teal-600,.text-teal-800,
        .text-gray-200,.text-gray-400,.text-gray-600,.text-gray-800,
        .hover\:bg-blue-100,.hover\:bg-blue-700,.hover\:bg-blue-900,
        .hover\:bg-purple-100,.hover\:bg-purple-700,.hover\:bg-purple-900,
        .hover\:bg-green-100,.hover\:bg-green-700,.hover\:bg-green-900,
        .hover\:bg-red-100,.hover\:bg-red-700,.hover\:bg-red-900,
        .hover\:bg-yellow-100,.hover\:bg-yellow-700,.hover\:bg-yellow-900,
        .hover\:bg-orange-100,.hover\:bg-orange-700,.hover\:bg-orange-900,
        .hover\:bg-pink-100,.hover\:bg-pink-700,.hover\:bg-pink-900,
        .hover\:bg-indigo-100,.hover\:bg-indigo-700,.hover\:bg-indigo-900,
        .hover\:bg-cyan-100,.hover\:bg-cyan-700,.hover\:bg-cyan-900,
        .hover\:bg-teal-100,.hover\:bg-teal-700,.hover\:bg-teal-900,
        .dark\:bg-blue-900,.dark\:bg-purple-900,.dark\:bg-green-900,.dark\:bg-red-900,.dark\:bg-yellow-900,
        .dark\:bg-orange-900,.dark\:bg-pink-900,.dark\:bg-indigo-900,.dark\:bg-cyan-900,.dark\:bg-teal-900,
        .dark\:text-blue-200,.dark\:text-purple-200,.dark\:text-green-200,.dark\:text-red-200,
        .dark\:text-yellow-200,.dark\:text-orange-200,.dark\:text-pink-200,.dark\:text-indigo-200,
        .dark\:text-cyan-200,.dark\:text-teal-200,
        .dark\:hover\:bg-blue-900,.dark\:hover\:bg-purple-900,.dark\:hover\:bg-green-900,
        .dark\:hover\:bg-red-900,.dark\:hover\:bg-yellow-900,.dark\:hover\:bg-orange-900,
        .ring-2,.ring-blue-500,.ring-purple-500,.ring-green-500,.ring-red-500,.ring-yellow-500,
        .ring-orange-500,.ring-pink-500,.ring-indigo-500,.ring-cyan-500,.ring-teal-500,
        .border-blue-500,.border-purple-500,.border-green-500,.border-red-500,.border-yellow-500,
        .border-orange-500,.border-pink-500,.border-indigo-500,.border-cyan-500,.border-teal-500,
        .hover\:border-blue-500,.hover\:border-purple-500,.hover\:border-green-500,
        .hover\:text-blue-300,.hover\:text-blue-700,.hover\:text-purple-300,.hover\:text-purple-700,
        .dark\:hover\:text-blue-300,.dark\:hover\:text-purple-300 { }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 min-h-screen transition-colors duration-200 overflow-x-hidden flex flex-col">
    <!-- Header -->
    <header class="bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-wrap justify-between items-center py-4 gap-4">
                <div class="min-w-0">
                    <a href="index.html" class="hover:opacity-80 transition-opacity">
                        <h1 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 dark:text-white">
                            Palikoita
                        </h1>
                    </a>
                    <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-1" id="categorySubtitle">
                        <!-- Filled by JavaScript -->
                    </p>
                </div>
                <div class="flex items-center gap-1 flex-wrap">
                    <button id="langToggle" class="p-2 sm:px-3 sm:py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium text-xs sm:text-sm">
                        EN
                    </button>
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle theme">
                        <svg id="sunIcon" class="w-4 h-4 sm:w-5 sm:h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                        </svg>
                        <svg id="moonIcon" class="w-4 h-4 sm:w-5 sm:h-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                        </svg>
                    </button>
                    <!-- Menu Button with Dropdown -->
                    <div class="relative">
                        <button onclick="toggleMenu()" class="p-2 sm:px-3 sm:py-2 bg-gradient-to-r from-purple-600 via-pink-600 to-orange-600 hover:from-purple-700 hover:via-pink-700 hover:to-orange-700 text-white rounded-lg font-medium flex items-center gap-2 transition-all shadow-lg hover:shadow-xl text-xs sm:text-sm">
                            <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                            <span class="hidden sm:inline lang-fi">Valikko</span>
                            <span class="hidden sm:inline lang-en">Menu</span>
                        </button>
                        <div id="menuDropdown" class="hidden absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-[70]">
                            <div class="py-2">
                                <button onclick="showAllLinksModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-orange-50 dark:hover:bg-orange-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Kaikki linkit</span>
                                        <span class="lang-en">All Links</span>
                                    </span>
                                </button>
                                <button onclick="showContactsModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-purple-50 dark:hover:bg-purple-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Kaikki yhteystiedot</span>
                                        <span class="lang-en">All Contacts</span>
                                    </span>
                                </button>
                                <button onclick="showSourcesModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-teal-50 dark:hover:bg-teal-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-teal-600 dark:text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Kaikki lähteet</span>
                                        <span class="lang-en">All Sources</span>
                                    </span>
                                </button>
                                <button onclick="showDownloadsModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-blue-50 dark:hover:bg-blue-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Lataa sisältöä</span>
                                        <span class="lang-en">Download Contents</span>
                                    </span>
                                </button>
                                <div class="border-t border-gray-200 dark:border-gray-700 my-2"></div>
                                <button onclick="showRoadmapModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-indigo-50 dark:hover:bg-indigo-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-indigo-600 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Tuleva sisältö</span>
                                        <span class="lang-en">Upcoming Content</span>
                                    </span>
                                </button>
                                <button onclick="showAboutModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-green-50 dark:hover:bg-green-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Tietoja sivusta</span>
                                        <span class="lang-en">About This Page</span>
                                    </span>
                                </button>
                                <button onclick="showFeedbackModal(); toggleMenu();" class="w-full px-4 py-3 text-left hover:bg-yellow-50 dark:hover:bg-yellow-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-yellow-600 dark:text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Palaute</span>
                                        <span class="lang-en">Feedback</span>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Category Nav Burger (mobile only) -->
                    <div class="relative md:hidden">
                        <button id="categoryNavBtn" onclick="toggleCategoryNav()" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                        <div id="categoryNavMenu" class="hidden absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-50">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Navigation (hidden on mobile, shown on desktop) -->
            <nav class="hidden md:block border-t border-gray-200 dark:border-gray-700 py-3">
                <div class="flex gap-4 justify-center" id="categoryNav">
                    <!-- Filled by JavaScript -->
                </div>
            </nav>
        </div>
    </header>

    <!-- About Modal -->
    <div id="aboutModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" onclick="if(event.target === this) closeAboutModal()">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col" onclick="event.stopPropagation();">
            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
                    <span class="lang-fi">Tietoja sivusta</span>
                    <span class="lang-en">About This Page</span>
                </h2>
                <button onclick="closeAboutModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="overflow-y-auto p-6">
                <div class="prose dark:prose-invert max-w-none">
                    <p class="text-gray-700 dark:text-gray-300 lang-fi">
                        Tämä sivusto on kokoelma hyödyllisiä linkkejä, yhteystietoja ja resursseja erityisesti tamperelaisille, mutta myös muille. Sivusto on rakennettu helpottamaan arkea ja löytämään tarvittavat tiedot nopeasti.
                    </p>
                    <p class="text-gray-700 dark:text-gray-300 lang-en">
                        This website is a collection of useful links, contact information, and resources especially for Tampere residents, but also for others. The site is built to make everyday life easier and find needed information quickly.
                    </p>
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mt-4 mb-2 lang-fi">Ominaisuudet</h3>
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mt-4 mb-2 lang-en">Features</h3>
                    <ul class="text-gray-700 dark:text-gray-300 space-y-2">
                        <li class="lang-fi">• Kategorioitu sisältö helpompaan navigointiin</li>
                        <li class="lang-en">• Categorized content for easier navigation</li>
                        <li class="lang-fi">• Tumma tila silmien säästämiseksi</li>
                        <li class="lang-en">• Dark mode to save your eyes</li>
                        <li class="lang-fi">• PDF-lataukset offline-käyttöä varten</li>
                        <li class="lang-en">• PDF downloads for offline use</li>
                        <li class="lang-fi">• Kaksikielinen (suomi/englanti)</li>
                        <li class="lang-en">• Bilingual (Finnish/English)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" onclick="if(event.target === this) closeFeedbackModal()">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col" onclick="event.stopPropagation();">
            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
                    <span class="lang-fi">Palaute</span>
                    <span class="lang-en">Feedback</span>
                </h2>
                <button onclick="closeFeedbackModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="overflow-y-auto p-6">
                <div class="space-y-4">
                    <p class="text-gray-700 dark:text-gray-300 lang-fi">
                        Haluamme kuulla mielipiteesi! Jos sinulla on ehdotuksia, kysymyksiä tai haluat ilmoittaa virheestä, ota yhteyttä.
                    </p>
                    <p class="text-gray-700 dark:text-gray-300 lang-en">
                        We want to hear from you! If you have suggestions, questions, or want to report an error, please get in touch.
                    </p>
                    <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                        <h3 class="font-semibold text-gray-900 dark:text-white mb-2 lang-fi">Lähetä palaute</h3>
                        <h3 class="font-semibold text-gray-900 dark:text-white mb-2 lang-en">Send Feedback</h3>
                        <p class="text-gray-700 dark:text-gray-300 text-sm">
                            <span class="lang-fi">Lisää tähän haluamasi palautelomake tai yhteystiedot</span>
                            <span class="lang-en">Add your preferred feedback form or contact information here</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Roadmap Modal -->
    <div id="roadmapModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" onclick="if(event.target === this) closeRoadmapModal()">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col" onclick="event.stopPropagation();">
            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
                    <span class="lang-fi">Tuleva sisältö</span>
                    <span class="lang-en">Upcoming Content</span>
                </h2>
                <button onclick="closeRoadmapModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="overflow-y-auto p-6" id="roadmapContent">
                <!-- Content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Download Contents Modal -->
    <div id="downloadsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-gray-900 dark:text-white">
                    <span class="lang-fi">Lataa sisältöä</span>
                    <span class="lang-en">Download Contents</span>
                </h2>
                <button onclick="closeDownloadsModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="space-y-3">
                <!-- Bookmarks Button -->
                <button onclick="closeDownloadsModal(); showExportModal('bookmark')" class="w-full p-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium flex items-center gap-3 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                    </svg>
                    <div class="text-left">
                        <div class="font-semibold">
                            <span class="lang-fi">Kirjanmerkit</span>
                            <span class="lang-en">Bookmarks</span>
                        </div>
                        <div class="text-sm opacity-90">
                            <span class="lang-fi">Lataa linkit HTML-kirjanmerkkeinä</span>
                            <span class="lang-en">Download links as HTML bookmarks</span>
                        </div>
                    </div>
                </button>
                
                <!-- PDF Button -->
                <button onclick="closeDownloadsModal(); showExportModal('pdf')" class="w-full p-4 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium flex items-center gap-3 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <div class="text-left">
                        <div class="font-semibold">
                            <span class="lang-fi">PDF</span>
                            <span class="lang-en">PDF</span>
                        </div>
                        <div class="text-sm opacity-90">
                            <span class="lang-fi">Lataa sisältö PDF-tiedostona</span>
                            <span class="lang-en">Download content as PDF file</span>
                        </div>
                    </div>
                </button>
                
                <!-- ZIP Button -->
                <button onclick="closeDownloadsModal(); showExportModal('zip')" class="w-full p-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium flex items-center gap-3 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
                    </svg>
                    <div class="text-left">
                        <div class="font-semibold">
                            <span class="lang-fi">ZIP</span>
                            <span class="lang-en">ZIP</span>
                        </div>
                        <div class="text-sm opacity-90">
                            <span class="lang-fi">Lataa linkit arkistotiedostona</span>
                            <span class="lang-en">Download links as archive file</span>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Export Selection Modals -->
    <div id="pdfModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
                <span class="lang-fi">Lataa PDF</span>
                <span class="lang-en">Download PDF</span>
            </h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                <span class="lang-fi">Luo PDF-tiedosto valituista kategorioista. Sisältää kaikki tiedot, linkit ja kuvaukset.</span>
                <span class="lang-en">Create a PDF file from selected categories. Includes all information, links and descriptions.</span>
            </p>
            <div class="space-y-2 mb-6" id="pdfCategories"></div>
            <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mb-6">
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="pdfIncludeAllLinks" checked class="w-4 h-4 text-blue-600 rounded">
                    <span class="text-gray-900 dark:text-white font-medium">
                        <span class="lang-fi">Sisällytä kaikki linkit -PDF</span>
                        <span class="lang-en">Include All Links PDF</span>
                    </span>
                </label>
            </div>
            <div class="flex gap-2 justify-end">
                <button onclick="closeExportModal('pdf')" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                    <span class="lang-fi">Peruuta</span>
                    <span class="lang-en">Cancel</span>
                </button>
                <button onclick="confirmPdfDownload()" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                    <span class="lang-fi">Lataa PDF</span>
                    <span class="lang-en">Download PDF</span>
                </button>
            </div>
        </div>
    </div>

    <div id="zipModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
                <span class="lang-fi">Lataa ZIP</span>
                <span class="lang-en">Download ZIP</span>
            </h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                <span class="lang-fi">Luo ZIP-arkisto, joka sisältää erillisen PDF:n jokaisesta valitusta kategoriasta sekä yhdistetyn PDF:n kaikista.</span>
                <span class="lang-en">Create a ZIP archive containing separate PDFs for each selected category plus a combined PDF of all.</span>
            </p>
            <div class="space-y-2 mb-4" id="zipCategories"></div>
            <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mb-6 space-y-2">
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="zipIncludeCombined" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-gray-900 dark:text-white font-medium">
                        <span class="lang-fi">Sisällytä yhdistetty PDF (kaikki kategoriat yhdessä tiedostossa)</span>
                        <span class="lang-en">Include combined PDF (all categories in one file)</span>
                    </span>
                </label>
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="zipIncludeBookmarks" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-gray-900 dark:text-white font-medium">
                        <span class="lang-fi">Sisällytä kirjanmerkkitiedosto</span>
                        <span class="lang-en">Include bookmark file</span>
                    </span>
                </label>
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="zipIncludeAllLinks" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-gray-900 dark:text-white font-medium">
                        <span class="lang-fi">Sisällytä kaikki linkit -PDF</span>
                        <span class="lang-en">Include All Links PDF</span>
                    </span>
                </label>
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="zipIncludeItemPDFs" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-gray-900 dark:text-white font-medium">
                        <span class="lang-fi">Sisällytä erilliset PDF:t (kohteet, joissa PDF: true)</span>
                        <span class="lang-en">Include individual PDFs (items with PDF: true)</span>
                    </span>
                </label>
            </div>
            <div class="flex gap-2 justify-end">
                <button onclick="closeExportModal('zip')" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                    <span class="lang-fi">Peruuta</span>
                    <span class="lang-en">Cancel</span>
                </button>
                <button onclick="confirmZipDownload()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors">
                    <span class="lang-fi">Lataa ZIP</span>
                    <span class="lang-en">Download ZIP</span>
                </button>
            </div>
        </div>
    </div>

    <div id="bookmarkModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
                <span class="lang-fi">Lataa Kirjanmerkit</span>
                <span class="lang-en">Download Bookmarks</span>
            </h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                <span class="lang-fi">Vie linkit HTML-kirjanmerkkitiedostona, jonka voi tuoda selaimeen. Sisältää kansiorakenteen kategorioittain.</span>
                <span class="lang-en">Export links as HTML bookmarks file that can be imported to your browser. Includes folder structure by category.</span>
            </p>
            <div class="space-y-2 mb-6" id="bookmarkCategories"></div>
            <div class="flex gap-2 justify-end">
                <button onclick="closeExportModal('bookmark')" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                    <span class="lang-fi">Peruuta</span>
                    <span class="lang-en">Cancel</span>
                </button>
                <button onclick="confirmBookmarkDownload()" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                    <span class="lang-fi">Lataa Kirjanmerkit</span>
                    <span class="lang-en">Download Bookmarks</span>
                </button>
            </div>
        </div>
    </div>

    <main class="flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 w-full">
        <!-- Category Content Section -->
        <div class="bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm rounded-2xl shadow-xl p-8">
            <!-- Header with controls -->
            <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white" id="categoryTitle">
                    <!-- Filled by JavaScript -->
                </h2>
                <div class="flex gap-2 items-center flex-wrap">
                    <!-- Category Download Menu -->
                    <div class="relative" id="categoryDownloadMenuContainer">
                        <button onclick="toggleCategoryDownloadMenu()" class="p-2 sm:px-4 sm:py-2 bg-red-700 hover:bg-red-800 text-white rounded-lg font-medium flex items-center gap-2 transition-all shadow-lg hover:shadow-xl">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                            </svg>
                            <span class="hidden sm:inline lang-fi">Lataa</span>
                            <span class="hidden sm:inline lang-en">Download</span>
                        </button>
                        <div id="categoryDownloadDropdown" class="hidden absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-[60]">
                            <div class="py-2">
                                <button onclick="showAllLinksModal(currentMainTag); toggleCategoryDownloadMenu();" class="w-full px-4 py-3 text-left hover:bg-orange-50 dark:hover:bg-orange-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Linkit</span>
                                        <span class="lang-en">Links</span>
                                    </span>
                                </button>
                                <button onclick="downloadCategoryBookmarks(); toggleCategoryDownloadMenu();" class="w-full px-4 py-3 text-left hover:bg-green-50 dark:hover:bg-green-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">Kirjanmerkit</span>
                                        <span class="lang-en">Bookmarks</span>
                                    </span>
                                </button>
                                <button onclick="downloadCategoryPDF(); toggleCategoryDownloadMenu();" class="w-full px-4 py-3 text-left hover:bg-red-50 dark:hover:bg-red-900/30 flex items-center gap-3 transition-colors">
                                    <svg class="w-5 h-5 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    <span class="text-gray-700 dark:text-gray-300 font-medium">
                                        <span class="lang-fi">PDF</span>
                                        <span class="lang-en">PDF</span>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sorting Burger Menu -->
                    <div class="relative">
                        <button id="sortMenuBtn" onclick="toggleSortMenu()" class="p-2 sm:px-4 sm:py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg font-medium flex items-center gap-2 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"></path>
                            </svg>
                            <span class="hidden sm:inline lang-fi">Järjestä</span>
                            <span class="hidden sm:inline lang-en">Sort</span>
                        </button>
                        <div id="sortMenu" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-50">
                            <button data-sort="default" onclick="changeSortMode('default'); toggleSortMenu()" class="sort-menu-item w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-t-lg text-gray-900 dark:text-white">
                                <span class="lang-fi">Oletus</span>
                                <span class="lang-en">Default</span>
                            </button>
                            <button data-sort="added" onclick="changeSortMode('added'); toggleSortMenu()" class="sort-menu-item w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-900 dark:text-white">
                                <span class="lang-fi">Lisätty</span>
                                <span class="lang-en">Date Added</span>
                            </button>
                            <button data-sort="updated" onclick="changeSortMode('updated'); toggleSortMenu()" class="sort-menu-item w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-900 dark:text-white">
                                <span class="lang-fi">Päivitetty</span>
                                <span class="lang-en">Date Updated</span>
                            </button>
                            <button data-sort="alphabetical" onclick="changeSortMode('alphabetical'); toggleSortMenu()" class="sort-menu-item w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-900 dark:text-white">
                                <span class="lang-fi">Aakkosjärjestys</span>
                                <span class="lang-en">Alphabetical</span>
                            </button>
                            <button data-sort="tags" onclick="changeSortMode('tags'); toggleSortMenu()" class="sort-menu-item w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-b-lg text-gray-900 dark:text-white">
                                <span class="lang-fi">Tagit</span>
                                <span class="lang-en">Tags</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- View Toggle -->
                    <button id="viewToggle" class="p-2 sm:px-4 sm:py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg font-medium flex items-center gap-2 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        <!-- Filled by JavaScript -->
                    </button>
                </div>
            </div>

            <!-- Search Bar and Tag Filters -->
            <div class="mb-6 flex gap-2">
                <input 
                    type="text" 
                    id="searchInput" 
                    class="flex-1 px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-primary focus:border-transparent transition-colors"
                    placeholder="">
                <!-- Filter button -->
                <button onclick="toggleTagFilters()" class="px-3 sm:px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg font-medium flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                    </svg>
                    <span class="hidden sm:inline">
                        <span class="lang-fi">Suodata tageilla</span>
                        <span class="lang-en">Filter by tags</span>
                    </span>
                </button>
            </div>

            <!-- Tag Filters Container -->
            <div class="mb-6">
                <!-- Tag filters container (hidden by default on all screens) -->
                <div id="tagFiltersContainer" class="hidden">
                    <div class="flex justify-end items-center mb-3">
                        <button id="multiSelectToggle" class="px-3 py-1 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-sm font-medium">
                            <span class="lang-fi">Valitse useita</span>
                            <span class="lang-en hidden">Multi-select</span>
                        </button>
                    </div>
                    <div id="tagFilters" class="flex flex-wrap gap-2">
                        <!-- Tags will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Results Count -->
            <div class="mb-4">
                <p id="resultCount" class="text-sm text-gray-600 dark:text-gray-400">
                    <!-- Filled by JavaScript -->
                </p>
            </div>

            <!-- Content Grid -->
            <div id="allContent" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Content will be inserted here by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Tip Modal -->
    <div id="tipModal" class="hidden fixed inset-0 z-[100] overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75" onclick="closeTipModal()"></div>
            
            <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
                <div class="bg-white dark:bg-gray-800 px-6 pt-5 pb-4">
                    <div class="flex justify-between items-start mb-4 gap-2">
                        <h3 id="modalTitle" class="text-2xl font-bold text-gray-900 dark:text-white flex-1"></h3>
                        <div class="flex gap-2 items-center flex-shrink-0">
                            <div id="modalPdfButton"></div>
                            <button onclick="closeTipModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="mt-3">
                        <p id="modalDescription" class="text-gray-600 dark:text-gray-300 mb-4"></p>
                        <div id="modalBody"></div>
                        <div id="modalLinks"></div>
                        <div class="flex flex-wrap gap-2 mb-4 mt-6" id="modalTags"></div>
                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-4" id="modalDate"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load Scripts -->
    <script>
        // Toggle menu dropdown
        function toggleMenu() {
            const dropdown = document.getElementById('menuDropdown');
            const categoryDownloadDropdown = document.getElementById('categoryDownloadDropdown');
            const categoryNavMenu = document.getElementById('categoryNavMenu');
            
            const isCurrentlyHidden = dropdown.classList.contains('hidden');
            
            // Close other menus first
            if (categoryDownloadDropdown) {
                categoryDownloadDropdown.classList.add('hidden');
            }
            if (categoryNavMenu) {
                categoryNavMenu.classList.add('hidden');
            }
            
            // Then toggle main menu
            if (isCurrentlyHidden) {
                dropdown.classList.remove('hidden');
            } else {
                dropdown.classList.add('hidden');
            }
        }
        
        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('menuDropdown');
            const menuButton = event.target.closest('button[onclick="toggleMenu()"]');
            const categoryDownloadButton = event.target.closest('button[onclick="toggleCategoryDownloadMenu()"]');
            const categoryNavButton = event.target.closest('button[onclick="toggleCategoryNav()"]');
            
            if (!menuButton && !categoryDownloadButton && !categoryNavButton && !dropdown?.contains(event.target)) {
                dropdown?.classList.add('hidden');
            }
        });

        // Toggle category download menu
        function toggleCategoryDownloadMenu() {
            const dropdown = document.getElementById('categoryDownloadDropdown');
            const menuDropdown = document.getElementById('menuDropdown');
            const categoryNavMenu = document.getElementById('categoryNavMenu');
            
            if (!dropdown) return;
            
            const isCurrentlyHidden = dropdown.classList.contains('hidden');
            
            // Close other menus first
            if (menuDropdown && !menuDropdown.classList.contains('hidden')) {
                menuDropdown.classList.add('hidden');
            }
            if (categoryNavMenu && !categoryNavMenu.classList.contains('hidden')) {
                categoryNavMenu.classList.add('hidden');
            }
            
            // Then toggle category download menu
            if (isCurrentlyHidden) {
                dropdown.classList.remove('hidden');
            } else {
                dropdown.classList.add('hidden');
            }
        }

        // Close category download menu when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('categoryDownloadDropdown');
            const menuButton = event.target.closest('button[onclick="toggleCategoryDownloadMenu()"]');
            const mainMenuButton = event.target.closest('button[onclick="toggleMenu()"]');
            const categoryNavButton = event.target.closest('button[onclick="toggleCategoryNav()"]');
            
            if (!menuButton && !mainMenuButton && !categoryNavButton && !dropdown?.contains(event.target)) {
                dropdown?.classList.add('hidden');
            }
        });

        // Modal functions for About, Feedback, and Roadmap
        function showAboutModal() {
            const modal = document.getElementById('aboutModal');
            if (modal) {
                // Update content from markdown if available
                if (window.roadmapData && window.roadmapData.about) {
                    const currentLang = window.currentLang || 'fi';
                    const aboutContent = currentLang === 'fi' ? window.roadmapData.about.fi : window.roadmapData.about.en;
                    const contentDiv = modal.querySelector('.overflow-y-auto .prose');
                    if (contentDiv && aboutContent) {
                        // Convert markdown to simple HTML
                        const htmlContent = convertMarkdownToHTML(aboutContent);
                        contentDiv.innerHTML = htmlContent;
                    }
                }
                modal.classList.remove('hidden');
                if (typeof applyLanguage === 'function') applyLanguage();
            }
        }

        function closeAboutModal() {
            const modal = document.getElementById('aboutModal');
            if (modal) modal.classList.add('hidden');
        }

        function showFeedbackModal() {
            const modal = document.getElementById('feedbackModal');
            if (modal) {
                // Update content from markdown if available
                if (window.roadmapData && window.roadmapData.feedback) {
                    const currentLang = window.currentLang || 'fi';
                    const feedbackContent = currentLang === 'fi' ? window.roadmapData.feedback.fi : window.roadmapData.feedback.en;
                    const contentDiv = modal.querySelector('.overflow-y-auto .space-y-4');
                    if (contentDiv && feedbackContent) {
                        // Convert markdown to simple HTML
                        const htmlContent = convertMarkdownToHTML(feedbackContent);
                        contentDiv.innerHTML = htmlContent;
                    }
                }
                modal.classList.remove('hidden');
                if (typeof applyLanguage === 'function') applyLanguage();
            }
        }

        function closeFeedbackModal() {
            const modal = document.getElementById('feedbackModal');
            if (modal) modal.classList.add('hidden');
        }

        // Simple markdown to HTML converter
        function convertMarkdownToHTML(markdown) {
            let html = markdown;
            
            // Headers
            html = html.replace(/^### (.*?)$/gm, '<h3 class="text-lg font-semibold text-gray-900 dark:text-white mt-4 mb-2">$1</h3>');
            html = html.replace(/^## (.*?)$/gm, '<h2 class="text-xl font-bold text-gray-900 dark:text-white mt-6 mb-3">$1</h2>');
            
            // Bold and italic
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // Lists
            html = html.replace(/^- (.*?)$/gm, '<li class="text-gray-700 dark:text-gray-300">$1</li>');
            
            // Wrap consecutive list items in ul
            html = html.replace(/(<li.*?<\/li>\n?)+/g, '<ul class="list-disc list-inside space-y-1 mb-4">$&</ul>');
            
            // Paragraphs (lines that don't start with HTML tags)
            html = html.split('\n\n').map(para => {
                if (para.trim() && !para.trim().startsWith('<')) {
                    return `<p class="text-gray-700 dark:text-gray-300 mb-4">${para.trim()}</p>`;
                }
                return para;
            }).join('\n');
            
            return html;
        }

        function showRoadmapModal() {
            const modal = document.getElementById('roadmapModal');
            if (!modal || !window.roadmapData) return;
            
            const content = document.getElementById('roadmapContent');
            if (!content) return;
            
            const statusColors = {
                'completed': 'green',
                'in-progress': 'blue',
                'planned': 'gray'
            };
            
            const statusIcons = {
                'completed': '<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>',
                'in-progress': '<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path></svg>',
                'planned': '<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd"></path></svg>'
            };
            
            let html = '<div class="space-y-6">';
            
            window.roadmapData.sections.forEach((section, index) => {
                const color = statusColors[section.status] || 'gray';
                const icon = statusIcons[section.status] || statusIcons.planned;
                
                html += `
                    <div class="relative ${index !== window.roadmapData.sections.length - 1 ? 'pb-8' : ''}">
                        ${index !== window.roadmapData.sections.length - 1 ? `<span class="absolute top-5 left-5 -ml-px h-full w-0.5 bg-${color}-200 dark:bg-${color}-800"></span>` : ''}
                        <div class="relative flex items-start group">
                            <span class="h-10 w-10 rounded-full bg-${color}-100 dark:bg-${color}-900 flex items-center justify-center text-${color}-600 dark:text-${color}-400 flex-shrink-0">
                                ${icon}
                            </span>
                            <div class="ml-4 min-w-0 flex-1">
                                <div class="flex items-center gap-2 mb-2">
                                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">${section.title}</h3>
                                    <span class="px-2 py-1 text-xs rounded-full bg-${color}-100 dark:bg-${color}-900 text-${color}-800 dark:text-${color}-200">${section.status}</span>
                                </div>
                                <ul class="space-y-1">
                                    ${section.items.map(item => `
                                        <li class="text-gray-600 dark:text-gray-400 flex items-start gap-2">
                                            <svg class="w-4 h-4 mt-0.5 flex-shrink-0 text-${color}-500" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                            </svg>
                                            <span>${item}</span>
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
            modal.classList.remove('hidden');
            
            if (typeof applyLanguage === 'function') applyLanguage();
        }

        function closeRoadmapModal() {
            const modal = document.getElementById('roadmapModal');
            if (modal) modal.classList.add('hidden');
        }

        window.showAboutModal = showAboutModal;
        window.closeAboutModal = closeAboutModal;
        window.showFeedbackModal = showFeedbackModal;
        window.closeFeedbackModal = closeFeedbackModal;
        window.showRoadmapModal = showRoadmapModal;
        window.closeRoadmapModal = closeRoadmapModal;

        // ESC key to close modals
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const roadmapModal = document.getElementById('roadmapModal');
                const aboutModal = document.getElementById('aboutModal');
                const feedbackModal = document.getElementById('feedbackModal');
                
                if (roadmapModal && !roadmapModal.classList.contains('hidden')) {
                    closeRoadmapModal();
                } else if (aboutModal && !aboutModal.classList.contains('hidden')) {
                    closeAboutModal();
                } else if (feedbackModal && !feedbackModal.classList.contains('hidden')) {
                    closeFeedbackModal();
                }
            }
        });
    </script>
    <script src="loader.js"></script>
    <script src="app.js"></script>
    <script>
        // Get category from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const categoryId = urlParams.get('category');
        
        // Show all content (clear category filter)
        function showAllContent() {
            currentMainTag = null;
            // Update URL to remove category parameter
            const url = new URL(window.location);
            url.searchParams.delete('category');
            window.history.pushState({}, '', url);
            
            // Update title and subtitle immediately
            const allText = currentLang === 'fi' ? 'Kaikki kohteet' : 'All Items';
            document.title = `${allText} - Päivää!`;
            document.getElementById('categoryTitle').textContent = allText;
            document.getElementById('categorySubtitle').textContent = allText;
            
            // Hide category-specific buttons
            const categoryDownloadContainer = document.getElementById('categoryDownloadMenuContainer');
            if (categoryDownloadContainer) categoryDownloadContainer.style.display = 'none';
            
            generateCategoryNav();
            renderContent();
        }
        
        // Generate navigation menu
        function generateCategoryNav() {
            const nav = document.getElementById('categoryNav');
            const mobileNav = document.getElementById('categoryNavMenu');
            if (!nav || !window.mainTagDefinitions) return;
            
            nav.innerHTML = '';
            if (mobileNav) mobileNav.innerHTML = '';
            
            // Add "Home" link
            const homeLink = document.createElement('a');
            homeLink.href = 'index.html';
            homeLink.className = 'px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors font-medium';
            homeLink.textContent = currentLang === 'fi' ? '← Etusivu' : '← Home';
            nav.appendChild(homeLink);
            
            // Add mobile "Home" link
            if (mobileNav) {
                const mobileHomeLink = document.createElement('a');
                mobileHomeLink.href = 'index.html';
                mobileHomeLink.className = 'block px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors';
                mobileHomeLink.textContent = currentLang === 'fi' ? '← Etusivu' : '← Home';
                mobileNav.appendChild(mobileHomeLink);
            }
            
            // Add "All" button (shows all content on this page)
            const allLink = document.createElement('button');
            allLink.onclick = showAllContent;
            if (!currentMainTag) {
                allLink.className = 'px-4 py-2 rounded-lg bg-primary text-white font-medium';
            } else {
                allLink.className = 'px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors font-medium';
            }
            allLink.textContent = currentLang === 'fi' ? 'Kaikki' : 'All';
            nav.appendChild(allLink);
            
            // Add mobile "All" button
            if (mobileNav) {
                const mobileAllLink = document.createElement('button');
                mobileAllLink.onclick = showAllContent;
                if (!currentMainTag) {
                    mobileAllLink.className = 'block px-4 py-3 bg-primary text-white font-medium w-full text-left';
                } else {
                    mobileAllLink.className = 'block px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-full text-left';
                }
                mobileAllLink.textContent = currentLang === 'fi' ? 'Kaikki' : 'All';
                mobileNav.appendChild(mobileAllLink);
            }
            
            // Add category links
            Object.keys(window.mainTagDefinitions).forEach(mainTagId => {
                const mainTagDef = window.mainTagDefinitions[mainTagId];
                
                // Desktop link (slugified in URL)
                const link = document.createElement('a');
                link.href = `category.html?category=${window.slugify(mainTagId)}`;
                
                if (mainTagId === currentMainTag) {
                    link.className = 'px-4 py-2 rounded-lg bg-primary text-white font-medium';
                } else {
                    link.className = 'px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors font-medium';
                }
                
                link.textContent = mainTagDef[currentLang];
                nav.appendChild(link);
                
                // Mobile link
                if (mobileNav) {
                    const mobileLink = document.createElement('a');
                    mobileLink.href = `category.html?category=${window.slugify(mainTagId)}`;
                    
                    if (mainTagId === currentMainTag) {
                        mobileLink.className = 'block px-4 py-3 bg-primary text-white font-medium';
                    } else {
                        mobileLink.className = 'block px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors';
                    }
                    
                    mobileLink.textContent = mainTagDef[currentLang];
                    mobileNav.appendChild(mobileLink);
                }
            });
        }
        
        // If content is already loaded (fast path), initialize immediately to avoid missing the event
        if (window.mainTagDefinitions && Object.keys(window.mainTagDefinitions).length > 0) {
// Resolve possible slugified category param to actual mainTagId
        let resolvedCategory = null;
        if (categoryId) {
            if (window.mainTagDefinitions[categoryId]) {
                resolvedCategory = categoryId;
            } else {
                // Build slug map and try to match
                for (const id of Object.keys(window.mainTagDefinitions || {})) {
                    if (window.slugify(id) === categoryId) {
                        resolvedCategory = id;
                        break;
                    }
                }
            }
        }

        if (resolvedCategory) {
            currentMainTag = resolvedCategory;
            const categoryDef = window.mainTagDefinitions[resolvedCategory];

                // Update page title and subtitle
                document.title = `${categoryDef[currentLang]} - Päivää!`;
                document.getElementById('categoryTitle').textContent = categoryDef[currentLang];
                document.getElementById('categorySubtitle').textContent = categoryDef[currentLang];
                
                // Show category-specific buttons
                const categoryDownloadContainer = document.getElementById('categoryDownloadMenuContainer');
                if (categoryDownloadContainer) categoryDownloadContainer.style.display = 'block';
            } else {
                // No category - show all content
                currentMainTag = null;
                const allText = currentLang === 'fi' ? 'Kaikki kohteet' : 'All Items';
                document.title = `${allText} - Päivää!`;
                document.getElementById('categoryTitle').textContent = allText;
                document.getElementById('categorySubtitle').textContent = allText;
                
                // Hide category-specific buttons
                const categoryDownloadContainer = document.getElementById('categoryDownloadMenuContainer');
                if (categoryDownloadContainer) categoryDownloadContainer.style.display = 'none';
            }

            initializePage();
            generateCategoryNav();
            renderTagFilters();
            renderContent();
        }

        // Initialize the page when content is loaded (fallback if not yet loaded)
        window.addEventListener('contentLoaded', (e) => {
            window.contentData = e.detail.content;
            window.mainTagDefinitions = e.detail.mainTagDefinitions;
            window.tagDefinitions = e.detail.tagDefinitions;
            
            // Resolve possible slugified category param to actual mainTagId (handles ä/ö/etc)
            let resolvedCategory = null;
            if (categoryId) {
                if (window.mainTagDefinitions[categoryId]) {
                    resolvedCategory = categoryId;
                } else {
                    for (const id of Object.keys(window.mainTagDefinitions || {})) {
                        if (window.slugify(id) === categoryId) {
                            resolvedCategory = id;
                            break;
                        }
                    }
                }
            }

            if (resolvedCategory) {
                currentMainTag = resolvedCategory;
                const categoryDef = window.mainTagDefinitions[resolvedCategory];

                // Update page title and subtitle
                document.title = `${categoryDef[currentLang]} - Päivää!`;
                document.getElementById('categoryTitle').textContent = categoryDef[currentLang];
                document.getElementById('categorySubtitle').textContent = categoryDef[currentLang];
                
                // Show category-specific buttons
                const categoryDownloadContainer = document.getElementById('categoryDownloadMenuContainer');
                if (categoryDownloadContainer) categoryDownloadContainer.style.display = 'block';
            } else {
                // No category - show all content
                currentMainTag = null;
                const allText = currentLang === 'fi' ? 'Kaikki kohteet' : 'All Items';
                document.title = `${allText} - Päivää!`;
                document.getElementById('categoryTitle').textContent = allText;
                document.getElementById('categorySubtitle').textContent = allText;
                
                // Hide category-specific buttons
                const categoryDownloadContainer = document.getElementById('categoryDownloadMenuContainer');
                if (categoryDownloadContainer) categoryDownloadContainer.style.display = 'none';
            }
            
            initializePage();
            generateCategoryNav();
            renderTagFilters();
            renderContent();
        });
        
        // Download PDF for current category
        function downloadCategoryPDF() {
            if (currentMainTag) {
                downloadMainTagPDF(currentMainTag);
            }
        }
    </script>

    <!-- All Links Modal -->
    <div id="allLinksModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8">
                <div class="flex justify-between items-start mb-6 gap-2">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white flex-1">
                        <span class="lang-fi">Kaikki linkit</span>
                        <span class="lang-en">All Links</span>
                    </h3>
                    <div class="flex gap-2 items-center flex-shrink-0">
                        <button onclick="openAllLinksFullPage()" class="inline-flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors" title="Open in full page">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                            </svg>
                            <span class="hidden sm:inline lang-fi">Koko sivu</span>
                            <span class="hidden sm:inline lang-en">Full Page</span>
                        </button>
                        <button onclick="downloadAllLinksPDF()" class="inline-flex items-center gap-2 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors" title="Download as PDF">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="hidden sm:inline">PDF</span>
                        </button>
                        <button onclick="closeAllLinksModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                    <span class="lang-fi">Tässä näkyvät kaikki sivulla esiintyvät linkit.</span>
                    <span class="lang-en">This shows all links found on the site.</span>
                </p>
                <!-- Category Filter -->
                <div class="mb-4 border-b border-gray-200 dark:border-gray-700 pb-4">
                    <button onclick="toggleAllLinksFilter()" class="flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                        </svg>
                        <span class="lang-fi">Suodata kategorioita</span>
                        <span class="lang-en">Filter categories</span>
                    </button>
                    <div id="allLinksFilter" class="hidden mt-3 grid grid-cols-2 md:grid-cols-3 gap-2">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div id="allLinksContent" class="overflow-x-auto">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Contacts Modal -->
    <div id="contactsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8">
                <div class="flex justify-between items-start mb-6 gap-2">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white flex-1">
                        <span class="lang-fi">Yhteystiedot</span>
                        <span class="lang-en">Contact Information</span>
                    </h3>
                    <div class="flex gap-2 items-center flex-shrink-0">
                        <button onclick="openContactsFullPage()" class="inline-flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors" title="Open in full page">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                            </svg>
                            <span class="hidden sm:inline lang-fi">Koko sivu</span>
                            <span class="hidden sm:inline lang-en">Full Page</span>
                        </button>
                        <button onclick="downloadContactsPDF()" class="inline-flex items-center gap-2 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors" title="Lataa yhteystiedot PDF:nä | Download contacts as PDF">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="hidden sm:inline">PDF</span>
                        </button>
                        <button onclick="closeContactsModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                    <span class="lang-fi">Tässä näkyvät kaikki sivulla esiintyvät yhteystietolinkit.</span>
                    <span class="lang-en">This shows all contact links found on the site.</span>
                </p>
                <!-- Category Filter -->
                <div class="mb-4 border-b border-gray-200 dark:border-gray-700 pb-4">
                    <button onclick="toggleContactsFilter()" class="flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                        </svg>
                        <span class="lang-fi">Suodata kategorioita</span>
                        <span class="lang-en">Filter categories</span>
                    </button>
                    <div id="contactsFilter" class="hidden mt-3 grid grid-cols-2 md:grid-cols-3 gap-2">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div id="contactsContent" class="overflow-x-auto">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Sources Modal -->
    <div id="sourcesModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8">
                <div class="flex justify-between items-start mb-6 gap-2">
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white flex-1">
                        <span class="lang-fi">Lähteet</span>
                        <span class="lang-en">Sources</span>
                    </h3>
                    <div class="flex gap-2 items-center flex-shrink-0">
                        <button onclick="openSourcesFullPage()" class="inline-flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors" title="Open in full page">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                            </svg>
                            <span class="hidden sm:inline lang-fi">Koko sivu</span>
                            <span class="hidden sm:inline lang-en">Full Page</span>
                        </button>
                        <button onclick="downloadSourcesPDF()" class="inline-flex items-center gap-2 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors" title="Lataa lähteet PDF:nä | Download sources as PDF">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="hidden sm:inline">PDF</span>
                        </button>
                        <button onclick="closeSourcesModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
                    <span class="lang-fi">Tässä näkyvät kaikki sivulla käytetyt lähteet.</span>
                    <span class="lang-en">This shows all sources used on the site.</span>
                </p>
                <!-- Category Filter -->
                <div class="mb-4 border-b border-gray-200 dark:border-gray-700 pb-4">
                    <button onclick="toggleSourcesFilter()" class="flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                        </svg>
                        <span class="lang-fi">Suodata kategorioita</span>
                        <span class="lang-en">Filter categories</span>
                    </button>
                    <div id="sourcesFilter" class="hidden mt-3 grid grid-cols-2 md:grid-cols-3 gap-2">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div id="sourcesContent" class="overflow-x-auto">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-100 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <p class="text-center text-sm text-gray-600 dark:text-gray-400">
                <span class="lang-fi">Päivitetty viimeksi: 24.1.2026</span>
                <span class="lang-en">Last updated: 24.1.2026</span>
            </p>
        </div>
    </footer>
</body>
</html>
